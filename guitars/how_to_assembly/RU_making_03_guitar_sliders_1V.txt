EndlessGuitar: 1-струнная 1-битная электрогитара из швабры на Arduino Uno.

По стоимости конструкции, если покупать в магазинах шаговой доступности:
1. Корпус - "Швабра обжимная с насадкой из ПВА MopP-06, длина 115см",  400 р
2. Струны для бас-гитары 1000 р
7. Звукосниматель, 1000 руб.
3. Комплект одиночных колков 1200 р
4. Метизы для крепления струны 200 руб.
5. Arduino Uno или Arduino Nano 400 р
6. 2 подстроечных резистора 10 кОм, 40 р
8. Разъем "мини-джек" (3.5), 50 руб.
9. Макетная плата на 400 точек 100 руб.
10. Провода "вилка-вилка", 20 шт 50 руб.
11. Три переменных резистора SL-20V1-A10K, 10 кОм 200 руб.
Итого: 4700 руб.

Если заказывать из Китая, то стоимость получится меньше. 
Общая стоимость всех компонент - около 5000 рублей. 

Но, если у вас уже есть электрогитара - то можете использовать ее,
тогда вам нужно добавить лишь Ардуино (Uno или Nano), разъем "мини-джек", 3 потенциометра 10 кОм, подстроечный резистор 10 кОм
и провода для соединения.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

===== Введение ====== 
Привет. Я Денис Перевалов, участник коллектива "Музей вечно играющих аттракционов", 
в котором вместе с Анастасией Крохалевой мы создаем арт-проекты - https://eamuseum.com

Один из наших проектов - электрогитара из швабры на Arduino:
[КАРТИНКА 01_view]

[ВИДЕО: https://www.youtube.com/watch?v=se3GxTyyy_U ]


Я расскажу, как собрать ее самостоятельно. 
Основа электронной начинки - это Arduino, звукосниматель и подстроечный резистор.
Они точно должны быть. Остальное - можно варьировать по желанию.
Я подбирал компоненты, чтобы обойтись минимумом пайки. 
Но, если вы планируете выступать с гитарой, то лучше не использовать макетную плату, а спаять все соединения.

Общая стоимость всех компонент - около 5000 рублей. 


====== Список компонентов ========

(I) Корпус гитары и струна

1. Корпус - "Швабра обжимная с насадкой из ПВА MopP-06, длина 115см". Фирма "Рыжий кот".
Мы гарантируем, что из данной швабры все получится, но если хотите, можете
использовать на свой риск  другие "корпуса", главное, чтобы корпус был достаточно крепким и не сгибался от натяжения струны,
и на него удалось бы закрепить колок для струны (см. пункт 3 "колки").

2. Струны для бас-гитары FLIGHT BN4530-5, либо какие-либо струны для электрогитары. 
Я использую басовые струны - они толще, чем струны обычной гитары, и мне нравится, когда у гитары низкий звук.
Также, толстые басовые струны практически не рвутся, в отличие от тонких струн обычной электрогитары.

3. Комплект одиночных колков Alice AD-016P (акустическая, электрогитара)
Нам потребуется один колок. В данную модель не входят самые толстые струны бас-гитары,
но мы гарантируем что эта модель соединится с нашим корпусом.

4. Метизы для крепления струны и колка:

Для фиксации конца струны:
1 болт M8 с 6-гранной головкой длиной не менее 40 мм (я использовал 45 мм),
1 гайка M8

Желоб для настройки высоты поднятия струны от корпуса гитары:
1 болт M8 с потайной головкой, с полной резьбой, длиной не 45 мм или более (я использовал 60 мм),
2 гайки M8

Для пропускания струны возле колка:
1 болт M6 c 6-гранной головкой, с полной резьбой, длиной не менее 40мм (я использовал 64 мм, после сборки можно подрезать),
2 шайбы 6x13-2
1 гайка M6 

Для фиксации колка:
3 шайбы 6x14-1 (внутренний диаметр 6мм, внешний диаметр 14мм, толщина 1 мм) 


(II) Электронная начинка 

5. Arduino Uno или Arduino Nano

6. 2 подстроечных резистора 10 кОм
https://shop.robotclass.ru/index.php?route=product/product&product_id=187

7. Звукосниматель (пьезодатчик),
GH QH-8B, MF00834 -  1900 руб (на фото),
либо GH KQ-3 - 1000 руб (более дешевый вариант)


8. Разъем "мини-джек" (3.5), который будет служить аудиовыходом.
В него вы будете втыкать провод от колонки или наушников.
Вариант с пайкой:
https://shop.robotclass.ru/index.php?route=product/product&product_id=1819
Вариант без пайки: можно купить удлинитель провода мини-джек вилка-разъем, 
отрезать разьем, зачистить его контакты и соединить его с помощью клеммников с проводами для Arduino (см. пункт 10 "провода").

9. Три переменных резистора SL-20V1-A10K, 10 кОм
- используются в качестве ручки настройки громкости и параметров звука
(можно использовать любые другие переменные резисторы на 10 кОм, на ваш вкус)


10. Макетная плата на 400 точек для крепления потенциометров
https://shop.robotclass.ru/index.php?route=product/product&product_id=140

(если вы хотите все пропаять, то используйте вместо этого перфорированную макетную плату)

11. Провода "вилка-вилка", 20 шт
https://shop.robotclass.ru/index.php?route=product/product&product_id=493
(если вы хотите все пропаять, то используйте вместо этого монтажные провода)



====== Порядок сборки ========

(I) Натягиваем струну на гитару
 
1. Выбор струны.
Я использовал вторую басовую струну (толщина "0065", то есть 0.065 дюйма, это около 1.7 мм) - это максимальная толщина,
которая поместилась в колки для обычной гитары. Вы можете использовать более тонкие струны, если хотите.
 
2. Крепеж струны.
Высверливаем в головке болта M8 отверстие толщиной 2 мм для струны, 
[КАРТИНКА 02_hole]

На заднем конце швабры высверливаем отверстие диаметром 8 мм, вставляем болт и протягиваем струну через него.

Струна оканчивается металлической втулкой - это утолщение зацепится за винт, 
и тем самым струна будет надежно закреплена.
[КАРТИНКА 03_struna1]


3. Создание желоба для регулировки высоты поднятия струны от корпуса гитары

Чуть ближе к началу гитары высверливаем отверстие для болта M8 с потайной головой,
накручиваем на болт него гайку M8, вставляем в отверстие и закрепляем второй гайкой M8.
"Желоб" на головке этого болта поворачиваем вдоль хода струны. 
Когда мы натянем струну (после крепежа колка), струна ляжет в этот желоб. 
Этот болт позволит нам регулировать высоту струны над звукоснимателем (мы это сделаем в пункте 7).

[КАРТИНКА 04_struna2]

4. Крепеж колка.
Снимаем с переднего конца швабры пластиковый наконечник, и высверливаем в нем отверстие под колок и винт M6. 
Вставляем колок, снаружи проложив две шайбы 6x14-1, внутри одну 
(без шайб резьбы гайки колка не хватает, чтобы затянуть его плотно на корпусе гитары).

5. Вставка струны в колок
После этого, продеваем струну через отверстие в винте и закрепляем в колке.

Теперь можно вращать ручку колка и натянуть струну. 

Внимание: не натягивайте струну слишком сильно, чтобы не лопнула струна (если вы используете тонкую струну)
или чтобы гитара не сложилась (если вы используете толстую струну).

Я не настраиваю струну на какой-то конкретный тон, но при игре какой-то песни подстраваю как заблагорассудится.


[КАРТИНКА 05_kolki]

На нашей гитаре уже можно играть. Осталось ее электрифицировать!


(II) Электрификация гитары


6. Разбираем звукосниматель и вынимаем его основную часть, обернутую в фольгу.

[КАРТИНКА 06_zvukosnim3]

7. Крепим звукосниматель на гитару с помощью термоклея.
После этого, настраиваем высоту поднятия струны путем подкручивания гаек на желобе (из пункта 3) так, чтобы с одной стороны, 
струна не зацепляла звукосниматель при игре, но в то же время, была как можно ниже, 
чтобы колебания струны лучше считывались звукоснимателем.

[КАРТИНКА 07_struna]

8. Собираем электрическую схему ввода звука в Ардуино:

- выход звукоснимателя подключаем к Gnd и A0 Arduino (Uno или Nano). 
Когда струна дернута, звукосниматель генерирует ток в диапазоне -0.1 .. 0.1 В.

- также к A0 мы подключаем выход построеченого резистора на 10 кОм, а входы к Gnd и 5V Arduino. 
Этот резистор позволяет нам сдвинуть диапазон тока, приходящего со звукоснимателя, на 0.5В, тогда диапазон получится 0.4..0.6 В.
Это значение уже больше 0 и мы будем считывать его с аналогового входа A0 

[КАРТИНКА 08_resistor] 

9. Собираем электрическую схему для переменных резисторов.

- первый резистор будет осуществлять регуляцию громкости, пропуская через себя звук, 
генерируемый Arduino на цифровом пине 2.
Поэтому, один вход потенциометра подключаем к Gnd Arduino, второй - к пину 2 Arduino, 
а выход - к сигнальному проводу разъема "мини-джек".
 
- второй и третий резисторы будут управлять параметрами 1-битного звука в Arduino.
Поэтому, мы подключаем один вход каждого резистора в цифровой пин 5, другой в цифровой пин 6 
(мы на них подадим в программе Gnd и +5 вольт), а выходы - в аналоговые пины Ардуино A4 и A5.

Про второй подстроечный резистор:
------------
4) Sliders - in this sketch used two sliders (I mean potentiometers 10kOhm) for controlling sound parameters.
Also you need trimmer resistor 10 kOhm.
From Arduino we will use output power: pin 5 (Gnd) and pin 6 (5V).

The final goal is to connect:
A4 - sample rate
A5 - sensitivity

Connect both sliders and trimmer resistor's inputs to pin 5 (Gnd).
Connect trimmer's resistor second input to pin 6 (5V).
The output of trimmer's resistor connect to second input of sliders.
Finally, connect sliders outputs to A4 and A5.
The trimmer resostor is reqired because in this sketch we are using Aref 1.1V for Arduino analog inputs, 
so without trimming sliders output value 1023 in the middle of slider's position.
Using trimmer resistor allows to adjust power to slider.
So after start sketch, send in Monitor Port "1" to start debug print, and adjust resistor to obtain sliders going to 1023 only at final position.
(Remark: using trimmer resistor instead fixed resistor is because it's flexible to adjust for different number of sliders and various Aref.)
------------


Я спаял схему для резисторов на отдельной перфорированной макетной плате, но вы можете использовать макетную плату без пайки.

[КАРТИНКА 09_sliders]
[КАРТИНКА 10_sliders2]

10. Завершаем сборку
Последний штрих - требуется соединить второй контакт "земля" от разъема "мини-джек" с землей Ардуино.
Теперь, электроника гитары собрана. 
Перед тем, как крепить все "намертво" к гитаре, давайте проверим, что все соединено верно и закачаем программу в Ардуино.
 
(III) Прошивка Ардуино и настройка подстроечного резистора
11. Подключите Ардуино к компьютеру и вкачайте в него скетч 03_guitar_sliders_1V.

12. Зайдите в режим отладочной печати и настройте подстроечный резистор.
Для этого, откройте монитор серийного порта и установите скорость обмена 500000 бод.
Теперь, нажмите клавишу "1" и Enter - то есть, отправьте в Arduino символ "1".
В этом случае, Arduino перейдет в режим отладочной печати, и будет печатать строки с значениями внутренних переменных.

Сейчас нас интересует "audio input" - это числа, приходящие на A0.
Вам нужно подкрутить подстроечный резистор так, чтобы в состоянии покоя струны A0 получал значение около 512.
(Из-за шумов, это значение будет чуть прыгать).

Внимание: когда значение, приходящее на A0, становится близким к 512, загорается встроенный светодиод Ардуино (на пине 13).
Это можно использовать, чтобы подстроить резистор без компьютера. 
Я заметил, что при подключении Ардуино к блоку питания, а не ноутбуку, это значение немного сбивается и нужно подстраивать.
Поэтому, мигающий светодиод - очень помогает в этом.

Примечание:
Чтобы выйти из режима отладочной печати - достаточно перезагрузить Ардуино кнопкой Reset, либо снова отправить в серийный порт символ "1".

13. Проверьте, что звукосниматель работает.
Для этого, в режиме отладочной печати дерните струну - значения на A0, печатаемые в монитор порта, должны отклоняться от 512, и затем возвращаться к ним,
когда струна затихнет (то есть звукосниматель сначала генерирует ток, затем ток сходит в 0).


14. Проверка переменных резисторов 2 и 3
Во включенном режиме отладочной печати два числа после слова "sliders" означают данные, 
приходящие на A4 и A5 с переменных резисторов.
Пошевелите этими резисторами - печатаемые значения должны меняться с 0 до 1023.

15. Проверка звука и переменного резистора 1
- Подключите к выходу миниджек колонку 
(можно и наушники, но, будьте осторожны, так как в результате настройки могут раздастся громкие звуки и щелчки,
поэтому все же безопаснее подключать колонки).

- Переведите резисторы 1, 2 и 3 в среднее положение.
- Дерните струну. Из колонки должен пойти звук. Двигайте резистор 1 в крайние положения,
при этом громкость звука должна плавно меняться от полной тишины до максимально громкой.

16. Проверка всего:
Дергайте на струну, двигайте слайдеры - 1-й это громкость, 2-й это частота дискретизации, 3-й это чувствительность.

(IV) Крепеж частей гитары
Закрепите все электронику на корпусе гитары, используя термоклей и стяжки.
Я рекомендую закрепить переменные резисторы так, чтобы их было легко регулировать во время игры.
А остальную электронику - на рабочей части швабры, чтобы ее, наоборот, не трогать во время игры.


